#!/bin/bash
batt="/sys/class/power_supply/BAT0"

# Symbols for charging, and not charging
batter=(      )
charge=(      )

charging="Charging"

stat="$(cat $batt/status)"
perc="$(cat $batt/capacity)"

time_left="$(upower -i /org/freedesktop/UPower/devices/battery_BAT0 | grep time)"
left=$([[ $time_left =~ .*:\ *(.*) ]] && echo ${BASH_REMATCH[1]})

# Choose array based on charging
if [ $stat == $charging ]; then
        symbol=(${charge[@]})
else
        symbol=(${batter[@]})
fi

# Choose symbol based on percentage
if [[ $1 == "simple" ]]; then
        sym='B'
elif [ $perc -le 14 ]; then
        sym=${symbol[0]}
elif [ $perc -le 29 ]; then
        sym=${symbol[1]}
elif [ $perc -le 43 ]; then
        sym=${symbol[2]}
elif [ $perc -le 57 ]; then
        sym=${symbol[3]}
elif [ $perc -le 71 ]; then
        sym=${symbol[4]}
elif [ $perc -le 86 ]; then
        sym=${symbol[5]}
else
        sym=${symbol[6]}
fi

echo "$sym $(cat $batt/capacity)% - $left left"

